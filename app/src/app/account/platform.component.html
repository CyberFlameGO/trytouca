<app-notification></app-notification>
<app-header-inside></app-header-inside>
<div
  class="wsl-min-h-screen-1 flex flex-col space-y-4 border-t border-gray-200 dark:border-gray-700">
  <div>
    <div
      class="container mx-auto flex h-16 items-center justify-between px-4 py-2">
      <div class="text-xl font-medium text-black dark:text-gray-300">
        Server Settings
      </div>
      <div class="print:hidden">
        <button
          class="wsl-btn-sm wsl-btn-primary group"
          type="button"
          routerLink="/~">
          Back to Dashboard
        </button>
      </div>
    </div>
  </div>
  <div>
    <div
      *ngIf="stats"
      class="container mx-auto grid gap-4 px-4 text-sm text-black dark:text-gray-300 sm:grid-cols-2 lg:grid-cols-3">
      <div
        class="wsl-box border border-gray-200 p-4 dark:border-gray-700 lg:col-span-1">
        <h4 class="font-medium">Database</h4>
        <ul class="px-4 py-2 leading-6">
          <li class="flex justify-between">
            <span>Versions:</span>
            <span>{{ stats.countBatches }}</span>
          </li>
          <li class="flex justify-between">
            <span>Test Cases:</span>
            <span>{{ stats.countElements }}</span>
          </li>
          <li class="flex justify-between">
            <span>Submissions:</span>
            <span>{{ stats.countMessages }}</span>
          </li>
        </ul>
      </div>
      <div
        class="wsl-box border border-gray-200 p-4 dark:border-gray-700 lg:col-span-1">
        <h4 class="font-medium">Disk Space</h4>
        <ul class="px-4 py-2 leading-6">
          <li class="flex justify-between">
            <span>Free:</span>
            <span>{{ stats.spaceFree | number: '1.0-0' }} GB</span>
          </li>
          <li class="flex justify-between">
            <span>Size:</span>
            <span>{{ stats.spaceSize | number: '1.0-0' }} GB</span>
          </li>
          <li class="flex justify-between">
            <span>Used:</span>
            <span>{{ stats.spaceUsed | percent: '1.0-0' }}</span>
          </li>
        </ul>
      </div>
      <div
        class="wsl-box border border-gray-200 p-4 dark:border-gray-700 lg:col-span-1">
        <h4 class="font-medium">Comparator</h4>
        <ul class="px-4 py-2 leading-6">
          <li class="flex justify-between">
            <span>Comparisons:</span>
            <span>{{ stats.countComparisons }}</span>
          </li>
          <li class="flex justify-between">
            <span>Average Process Time:</span>
            <span>
              {{ stats.cmpAvgProcessingTime | number: '1.0-0' }} ms/job
            </span>
          </li>
          <li class="flex justify-between">
            <span>Average Collection Time:</span>
            <span>
              {{ stats.cmpAvgCollectionTime | number: '1.0-0' }} ms/job
            </span>
          </li>
        </ul>
      </div>
    </div>
  </div>
  <div class="container mx-auto gap-4 px-4 md:grid md:grid-cols-3">
    <div
      class="wsl-box border border-gray-200 dark:border-gray-700 md:order-2 md:col-span-1">
      <h3 class="p-4 text-xl font-medium text-black dark:text-gray-300">
        Recent Events
      </h3>
      <div class="space-y-4 p-4">
        <div
          class="space-y-2 rounded-md border border-gray-100 bg-gray-50 p-4 text-sm text-black dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300"
          *ngFor="let event of events">
          <div class="flex-grow">
            <span
              class="font-medium text-sky-600 dark:text-sky-400"
              [title]="event.username">
              {{ event.fullname }}
            </span>
            <span>{{ event.copyText }}</span>
          </div>
          <div class="flex items-center justify-between">
            <div>
              {{ describeEventDate(event.eventDate) }}
            </div>
            <div class="flex space-x-1">
              <div
                class="flex cursor-pointer justify-center rounded border border-gray-300 bg-gray-100 p-2 text-xs font-medium text-gray-500 hover:bg-gray-200 dark:border-gray-600 dark:bg-gray-800 dark:hover:bg-gray-700"
                title="Copy email to clipboard"
                ngxClipboard
                [cbContent]="event.email"
                (cbOnSuccess)="onCopy($event, 'email address')">
                <ng-icon name="hero-mail" size="1rem"></ng-icon>
              </div>
              <div
                class="flex cursor-pointer justify-center rounded border border-gray-300 bg-gray-100 p-2 text-xs font-medium text-gray-500 hover:bg-gray-200 dark:border-gray-600 dark:bg-gray-800 dark:hover:bg-gray-700"
                *ngIf="event.copyLink"
                title="Copy link to clipboard"
                ngxClipboard
                [cbContent]="event.copyLink"
                (cbOnSuccess)="onCopy($event, 'link')">
                <ng-icon name="hero-clipboard-copy" size="1rem"></ng-icon>
              </div>
            </div>
          </div>
        </div>
        <div
          class="wsl-box rounded-md border border-gray-200 p-4 text-sm leading-6 text-black dark:border-gray-700 dark:text-gray-300"
          *ngIf="events.length === 0">
          This section lists noteworthy user events that may require your
          assistance. These events include account creation, password reset, and
          consecutive failed login attempts that are not automatically resolved
          by your users.
        </div>
      </div>
    </div>
    <div
      class="wsl-box border border-gray-200 p-4 dark:border-gray-700 md:col-span-2">
      <h3 class="text-xl font-medium text-black dark:text-gray-300">Users</h3>
      <ul class="px-4 py-2" *ngIf="user && accounts">
        <li
          class="group flex h-8 items-center rounded-md transition duration-500 hover:bg-gray-100 dark:hover:bg-gray-900"
          *ngFor="let account of accounts; let rowNumber = index">
          <div
            class="w-8 px-2 text-sm font-medium text-black dark:text-gray-300">
            {{ rowNumber + 1 }}
          </div>
          <div class="flex flex-grow items-center justify-between space-x-4">
            <div
              class="w-40 truncate whitespace-nowrap font-medium text-black dark:text-gray-300"
              [ngClass]="{
                'text-gray-300 line-through dark:text-gray-600':
                  account.suspended
              }">
              {{ account.fullname ?? 'Unknown' }}
              <span
                class="text-sm text-gray-500 dark:text-gray-300"
                *ngIf="user.username === account.username">
                (You)
              </span>
            </div>
            <div class="w-24 whitespace-nowrap">
              <span
                class="rounded-md bg-gray-100 px-2 py-1 text-sm text-gray-700 group-hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-200 dark:group-hover:bg-gray-700">
                {{ account.username }}
              </span>
            </div>
            <div class="w-24">
              <span
                class="rounded-md bg-gray-100 px-2 py-1 text-sm text-gray-700 group-hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-200 dark:group-hover:bg-gray-700">
                {{ account.role }}
              </span>
            </div>
          </div>
          <div
            wslDropdown
            class="flex cursor-pointer select-none items-center p-1 text-gray-300 hover:text-gray-700">
            <ng-icon
              class="wsl-dropdown-toggle h-full w-4"
              name="hero-dots-vertical"></ng-icon>
            <div
              class="wsl-dropdown-menu hidden w-48 text-sm"
              aria-labelledby="wsl-user-dropdown">
              <div
                class="wsl-dropdown-item"
                ngxClipboard
                [cbContent]="account.email"
                (cbOnSuccess)="onCopy($event, 'email address')">
                <a class="text-sky-600 dark:text-sky-400">Copy Email</a>
              </div>
              <div
                class="wsl-dropdown-item"
                *ngIf="account.username !== user.username && !account.suspended"
                (click)="suspendAccount(account)">
                <a class="text-sky-600 dark:text-sky-400">Suspend</a>
              </div>
              <div
                class="wsl-dropdown-item"
                *ngIf="
                  account.username !== user.username &&
                  account.suspended &&
                  account.activationLink
                "
                (click)="deleteAccount(account)">
                <a class="text-sky-600 dark:text-sky-400">Delete</a>
              </div>
            </div>
          </div>
        </li>
      </ul>
    </div>
  </div>
</div>
<app-help></app-help>
<app-footer></app-footer>
